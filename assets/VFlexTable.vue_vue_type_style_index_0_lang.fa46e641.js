import{A as e,o as l,d as a,b as t,f as r,G as o,c as n,h as s,aj as u,u as i,ak as c,v as d,$ as v,r as p,a6 as m,a7 as f,al as y,am as b,F as g,l as k,a as w,a4 as h,t as x,I as $,g as j,e as C,w as H,H as S,m as T}from"./index.81bb9900.js";const V=["data-th"],B=e({__name:"VFlexTableCell",props:{column:{default:()=>({})}},setup(e){const o=e;return(e,n)=>(l(),a("div",{class:r(["flex-table-cell is-relative",[o.column.bold&&"is-bold",o.column.media&&"is-media",!0===o.column.grow&&"is-grow","lg"===o.column.grow&&"is-grow-lg","xl"===o.column.grow&&"is-grow-xl",o.column.scrollX&&!o.column.scrollY&&"has-slimscroll-x",!o.column.scrollX&&o.column.scrollY&&"has-slimscroll",o.column.scrollX&&o.column.scrollY&&"has-slimscroll-all","end"===o.column.align&&"cell-end","center"===o.column.align&&"cell-center",o.column.cellClass]]),"data-th":o.column.label||void 0},[t(e.$slots,"default")],10,V))}}),O=e({props:{id:{type:String,required:!0},label:{type:String,default:void 0},modelValue:{type:String,default:void 0},noRouter:{type:Boolean,default:void 0},routerQueryKey:{type:String,default:"sort"}},emits:["update:modelValue"],setup(e,l){const a=o(),t=n((()=>{var l,t;return null!=(t=null!=(l=e.modelValue)?l:a.query[e.routerQueryKey])?t:""})),r=n((()=>t.value===`${e.id}:asc`)),i=n((()=>t.value===`${e.id}:desc`)),c=n((()=>r.value?`${e.id}:desc`:i.value?void 0:`${e.id}:asc`)),d=n((()=>{if(e.noRouter)return{};const l={...a.query};return e.routerQueryKey&&(l[e.routerQueryKey]=c.value),{name:a.name,params:a.params,query:l}})),v=a=>{if(l.emit("update:modelValue",c.value),e.noRouter)return a.preventDefault(),a.stopPropagation(),!1};return()=>{var a,o;const n=null==(o=null==(a=l.slots)?void 0:a.default)?void 0:o.call(a,{isDesc:i.value,isAsc:r.value,nextSort:c.value,value:t.value}),p=s(u,{to:d.value,onClick:v,onKeydown(e){"Space"===e.code&&(e.preventDefault(),e.stopPropagation(),e.target instanceof HTMLAnchorElement&&e.target.dispatchEvent(new MouseEvent("click")))}},{default(){const l=s("span",{key:`${t.value}`,class:"is-inline"},s("span",{class:"ml-3 iconify is-inline","data-icon":r.value?"fa:sort-asc":i.value?"fa:sort-desc":"fa:sort"}));return[null!=n?n:e.label,l]}});return s("span",{},p)}}}),R=Symbol(),K=e=>e,_=({key:e,order:l,a:a,b:t})=>{const r=a[e],o=t[e];return"string"==typeof r?"asc"===l?r.localeCompare(o):o.localeCompare(r):r>o?"asc"===l?1:-1:r<o?"asc"===l?-1:1:0},A=e({props:{data:{type:[Array,Function],default:void 0},columns:{type:Object,default:void 0},sort:{type:String,default:void 0},searchTerm:{type:String,default:void 0},limit:{type:Number,default:void 0},page:{type:Number,default:void 0},total:{type:Number,default:void 0},debounceSearch:{type:Number,default:300}},emits:["update:sort","update:page","update:limit","update:searchTerm"],setup(e,l){const a=i(),t=i(!1),r=i(""),o=n({get:()=>{var l;return null!=(l=e.sort)?l:r.value},set(a){void 0===e.sort?r.value=a:l.emit("update:sort",a)}}),u=i(""),f=n({get:()=>{var l;return null!=(l=e.searchTerm)?l:u.value},set(a){void 0===e.searchTerm?u.value=a:l.emit("update:searchTerm",a)}}),y=i(1),b=n({get:()=>{var l;return null!=(l=e.page)?l:y.value},set(a){void 0===e.page?y.value=a:l.emit("update:page",a)}}),g=i(10),k=n({get:()=>{var l;return Math.max(1,null!=(l=e.limit)?l:g.value)},set(a){void 0===e.limit?g.value=a:l.emit("update:limit",a)}}),w=n((()=>{const l=e.columns;if(!l)return l;const a={};return Object.keys(l).reduce(((e,a)=>{const t=l[a];return"string"==typeof t?e[a]={format:K,label:t,key:a}:"object"==typeof t&&(e[a]={format:K,label:a,key:a,...t},!0===t.sortable&&(t.renderHeader?e[a].renderHeader=()=>s(O,{id:a,noRouter:!0,modelValue:o.value,"onUpdate:modelValue":e=>o.value=e},{default:t.renderHeader}):e[a].renderHeader=()=>{var e;return s(O,{id:a,label:null!=(e=t.label)?e:a,noRouter:!0,modelValue:o.value,"onUpdate:modelValue":e=>o.value=e})}),!0!==t.searchable||t.sort||(e[a].sort=_)),e}),a),a})),h=n((()=>{let l=a.value;if(!l)return l;if("function"==typeof e.data)return l;if(j.value){const e=w.value?Object.values(w.value).filter((e=>!(!e||"string"==typeof e)&&!0===e.searchable)):[];if(e.length){const a=new RegExp(j.value,"i");l=l.filter(((l,t)=>e.some((e=>{if(!e.key)return!1;const r=l[e.key];return e.filter?e.filter({searchTerm:j.value,value:r,row:l,column:e,index:t}):"string"==typeof r&&r.match(a)}))))}}return l})),x=n((()=>{let l=h.value;if(!l)return l;if("function"==typeof e.data)return l;if(o.value&&o.value.includes(":")){const[e,a]=o.value.split(":"),t=w.value?Object.values(w.value).find((l=>!(!l||"string"==typeof l)&&(!0===l.sortable&&l.key===e))):null;if(t){const e=[...l];e.sort(((e,l)=>t.key&&t.sort?t.sort({order:a,column:t,key:t.key,a:e,b:l}):0)),l=e}}return l})),$=n((()=>{if("function"==typeof e.data)return a.value;if(!a.value)return a.value;let l=x.value;return null==l?void 0:l.slice(H.value,H.value+k.value)})),j=c(f,e.debounceSearch),C=n((()=>{var l,a,t;return null!=(t=null!=(a=e.total)?a:null==(l=x.value)?void 0:l.length)?t:0})),H=n((()=>(b.value-1)*k.value)),S=n((()=>C.value?Math.ceil(C.value/k.value):0));async function T(l){if("function"==typeof e.data){t.value=!0;try{a.value=await e.data({searchTerm:j.value,start:H.value,limit:k.value,sort:o.value,controller:l})}finally{t.value=!1}}}d([j,k],(()=>{1!==b.value&&(b.value=1)})),v((async l=>{let t;"function"==typeof e.data?(t=new AbortController,await T(t)):a.value=e.data,l((()=>{null==t||t.abort()}))}));const V=p({data:$,columns:w,loading:t,searchInput:f,searchTerm:j,start:H,page:b,limit:k,sort:o,total:C,totalPages:S,fetchData:T});return m(R,V),l.expose(V),()=>{var e,a;const t=null==(a=(e=l.slots).default)?void 0:a.call(e,V);return s("div",{class:"flex-table-wrapper"},t)}}}),q={key:0,class:"flex-table-header"},D=["tabindex","onKeydown","onClick"],E={key:0},F={class:"language-json py-4"},M=e({__name:"VFlexTable",props:{data:{default:()=>[]},columns:{default:void 0},printObjects:{type:Boolean},reactive:{type:Boolean},compact:{type:Boolean},rounded:{type:Boolean},separators:{type:Boolean},clickable:{type:Boolean},subtable:{type:Boolean},noHeader:{type:Boolean}},emits:["rowClick"],setup(e,{emit:o}){const s=e,u=f(R,null),i=n((()=>(null==u?void 0:u.data)?u.data:s.reactive?y(s.data)?s.data:p(s.data):b(s.data))),c=e=>e,d=n((()=>{var e;const l=null!=(e=null==u?void 0:u.columns)?e:s.columns;let a=[];if(l)for(const[t,r]of Object.entries(l))"string"==typeof r?a.push({format:c,label:r,key:t}):a.push({format:c,label:t,key:t,...r});else if(i.value.length>0)for(const[t]of Object.entries(i.value[0]))a.push({format:c,label:t,key:t});return a}));return(n,u)=>{const c=B;return l(),a("div",{class:r(["flex-table",[s.compact&&"is-compact",s.rounded&&"is-rounded",s.separators&&"with-separators",s.noHeader&&"no-header",s.clickable&&"is-table-clickable",s.subtable&&"sub-table"]])},[t(n.$slots,"header",{},(()=>[s.noHeader?j("",!0):(l(),a("div",q,[(l(!0),a(g,null,k($(d),(e=>t(n.$slots,"header-column",{key:"col"+e.key,column:e},(()=>[e.renderHeader?(l(),w(h({render:e.renderHeader}),{key:0,class:r([!0===e.grow&&"is-grow","lg"===e.grow&&"is-grow-lg","xl"===e.grow&&"is-grow-xl","end"===e.align&&"cell-end","center"===e.align&&"cell-center"])},null,8,["class"])):(l(),a("span",{key:1,class:r([!0===e.grow&&"is-grow","lg"===e.grow&&"is-grow-lg","xl"===e.grow&&"is-grow-xl","end"===e.align&&"cell-end","center"===e.align&&"cell-center"])},x(e.label),3))])))),128))]))])),t(n.$slots,"body",{},(()=>[(l(!0),a(g,null,k($(i),((u,i)=>(l(),a(g,{key:i},[t(n.$slots,"body-row-pre",{row:u,columns:$(d),index:i}),C("div",{class:r(["flex-table-item",[s.clickable&&"is-clickable"]]),tabindex:s.clickable?0:void 0,onKeydown:S(T((()=>{s.clickable&&o("rowClick",u,i)}),["prevent"]),["space"]),onClick:()=>{s.clickable&&o("rowClick",u,i)}},[t(n.$slots,"body-row",{row:u,columns:$(d),index:i},(()=>[(l(!0),a(g,null,k($(d),(o=>(l(),w(c,{key:"row"+o.key,column:o},{default:H((()=>[t(n.$slots,"body-cell",{row:u,column:o,index:i,value:o.format(u[o.key],u,i)},(()=>[o.renderRow?(l(),w(h({render:()=>{var e;return null==(e=o.renderRow)?void 0:e.call(o,u,o,i)}}),{key:0})):"object"==typeof o.format(u[o.key],u,i)?(l(),a("span",{key:1,class:r([o.cellClass,o.inverted&&"dark-inverted",!o.inverted&&(o.bold?"dark-text":"light-text")])},[e.printObjects?(l(),a("details",E,[C("div",F,[C("pre",null,[C("code",null,x(o.format(u[o.key],u,i)),1)])])])):j("",!0)],2)):(l(),a("span",{key:2,class:r([o.cellClass,o.inverted&&"dark-inverted",!o.inverted&&(o.bold?"dark-text":"light-text")])},x(o.format(u[o.key],u,i)),3))]))])),_:2},1032,["column"])))),128))]))],42,D),t(n.$slots,"body-row-post",{row:u,columns:$(d),index:i})],64)))),128))]))],2)}}});export{M as _,O as a,A as b,B as c};
